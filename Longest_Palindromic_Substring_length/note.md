This is a O(n^3) solution
